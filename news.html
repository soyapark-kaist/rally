<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="google" content="notranslate">
    <meta name="description" content="아무리 카대전에 말해도 해결되지 않는 인터넷 문제, 우리 목소리가 모이면 학교에 전해지지 않을까요?">
    <meta name="author" content="kixlab">
    <meta property="og:image" content="img/rally_brand.png" />
    <meta property="og:description" content="아무리 카대전에 말해도 해결되지 않는 인터넷 문제, 우리 목소리가 모이면 학교에 전해지지 않을까요?" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="HandheldFriendly" content="true" />
    <meta name="apple-mobile-web-app-capable" content="YES" />

    <title>아, 쫌! 인터넷</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="css/bootstrap-theme.min.css" />

    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link rel="stylesheet" href="css/custom.css" />

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/collect.css" />
    <link rel="stylesheet" href="css/timeline.css" />
    <link rel="stylesheet" href="css/news.css" />

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/3.6.7/firebase.js"></script>

    <script src="js/d3.min.js"></script>

    <script type="text/javascript" src="js/conf.js"></script>
    <script type="text/javascript" src="js/rally.js"></script>
    <script type="text/javascript" src="js/donutChart.js"></script>
    <script type="text/javascript" src="js/barChart.js"></script>
    <script type="text/javascript" src="js/news.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js', {
                    scope: '.'
                })
                .then(function(registration) {
                    console.log('Service Worker Registered');
                });

            navigator.serviceWorker.ready.then(function(registration) {
                console.log('Service Worker Ready');
            });
        }

        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-96659225-1', 'auto');
        ga('send', 'pageview');
    </script>
</head>

<body data-spy="scroll" data-target=".timeline-progress">
    <!-- nav bar -->
    <header class="navbar navbar-static-top" role="banner" style="margin-bottom: 0px;">
        <div class="navbar-header">
            <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".rally-navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./index.html" class="navbar-brand" style="padding:10px;">
                <img alt="Rally" src="img/achome_beta_brand.png" style="height: 100%;" />
            </a>
        </div>
        <nav class="collapse navbar-collapse rally-navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="./others.html" onclick="trackOutboundLink('./others.html','nav'); return false;">살펴보기</a></li>
                <li><a href="./collect.html" onclick="trackOutboundLink('./collect.html','nav'); return false;">제보하기</a></li>
            </ul>
        </nav>
    </header>
    <!--/nav bar-->

    <!-- Content -->
    <div class="content">
        <div class="container">
            <div class="timeline-progress">
                <ul data-spy="affix" class="nav">
                    <li>
                        <a href="#launch">
                            <span class="fa-stack fa-lg" data-toggle="tooltip" data-placement="bottom" title="제보 작성">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-pencil-square-o fa-stack-1x fa-inverse"></i>
                        </span>
                            <div>4/4 런칭</div>
                        </a>
                    </li>
                    <!--<li><i class="fa fa-chevron-right" aria-hidden="true"></i></li>
                    <li>
                        <span class="fa-stack fa-lg" data-toggle="tooltip" data-placement="top" title="우리 건물에 충분한 제보가 쌓이면 개선을 요구하기 위해 정보통신팀에 민원이 보내집니다.">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-bar-chart fa-stack-1x fa-inverse"></i>
                        </span>
                        <div>민원 준비중</div>
                    </li>-->
                    <li><i class="fa fa-chevron-right" aria-hidden="true"></i></li>
                    <li>
                        <a href="#stat">
                            <span class="fa-stack fa-lg" data-toggle="tooltip" data-placement="bottom" title="정보통신팀 전송">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                        </span>
                            <div>4/18 학교에 전송</div>
                        </a>
                    </li>
                    <li><i class="fa fa-chevron-right" aria-hidden="true"></i></li>
                    <li>
                        <a href="#response">
                            <span class="fa-stack fa-lg" data-toggle="tooltip" data-placement="bottom" title="정보통신팀에서 민원에 대한 답변을 했습니다">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-reply fa-stack-1x fa-inverse"></i>
                        </span>
                            <div>학교에서 답변</div>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="loading"></div>


            <div class="alert alert-info" role="alert" id="respond">
                <strong><i class="fa fa-check-square-o" aria-hidden="true"></i>정보통신팀 답변</strong><br><span class="respond-text">여기에 답변</span><br>
            </div>


            <!-- Response from school -->
            <div class="post">
                <h2 class="page-header" id="response">
                    <a href="#response" data-anchorjs-icon=""></a>학교에서 답변 도착</h2>
                <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta.
                    Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur sodales ligula in libero. Sed dignissim lacinia nunc. Curabitur tortor. Pellentesque
                    nibh. Aenean quam. In scelerisque sem at dolor. Maecenas mattis. Sed convallis tristique sem. Proin ut ligula vel nunc egestas porttitor. Morbi lectus risus, iaculis vel, suscipit quis, luctus non, massa. Fusce ac turpis quis ligula
                    lacinia aliquet. Mauris ipsum. Nulla metus metus, ullamcorper vel, tincidunt sed, euismod in, nibh. Quisque volutpat condimentum velit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nam
                    nec ante. Sed lacinia, urna non tincidunt mattis, tortor neque adipiscing diam, a cursus ipsum ante quis turpis. Nulla facilisi. Ut fringilla. Suspendisse potenti. Nunc feugiat mi a tellus consequat imperdiet. Vestibulum sapien. Proin
                    quam. Etiam ultrices. Suspendisse in justo eu magna luctus suscipit. Sed lectus. Integer euismod lacus luctus magna. Quisque cursus, metus vitae pharetra auctor, sem massa mattis sem, at interdum magna augue eget diam. Vestibulum ante
                    ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Morbi lacinia molestie dui. Praesent blandit dolor. Sed non quam. In vel mi sit amet augue congue elementum. Morbi in ipsum sit amet pede facilisis laoreet. Donec
                    lacus nunc, viverra nec, blandit vel, egestas et, augue. Vestibulum tincidunt malesuada tellus. Ut ultrices ultrices enim. Curabitur sit amet mauris. Morbi in dui quis est pulvinar ullamcorper. Nulla facilisi. Integer lacinia sollicitudin
                    massa. Cras metus. Sed aliquet risus a tortor. Integer id quam. Morbi mi. Quisque nisl felis, venenatis tristique, dignissim in, ultrices sit amet, augue. Proin sodales libero eget ante. Nulla quam. Aenean laoreet. Vestibulum nisi
                    lectus, commodo ac, facilisis ac, ultricies eu, pede. Ut orci risus, accumsan porttitor, cursus quis, aliquet eget, justo. Sed pretium blandit orci. Ut eu diam at pede suscipit sodales. Aenean lectus elit, fermentum non, convallis
                    id, sagittis at, neque.

                    <h3>
                        <i class="fa fa-building-o fa-2x" aria-hidden="true"></i> 세종관
                    </h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus
                        sed augue semper porta. Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur sodales ligula in libero. Sed dignissim lacinia nunc.
                        Curabitur tortor. Pellentesque nibh.
                    </p>

                    <h3>
                        <i class="fa fa-building-o fa-2x" aria-hidden="true"></i> 희망관
                    </h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus
                        sed augue semper porta. Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur sodales ligula in libero. Sed dignissim lacinia nunc.
                        Curabitur tortor. Pellentesque nibh.
                    </p>


                    <ul class="nav nav-pills nav-justified">
                        <li role="presentation"><a data-toggle="pill" href="#like"><i class="fa fa-thumbs-o-up fa-4x" aria-hidden="true"></i><span class="answer-text">수고하셨습니다!</span></a></li>
                        <li role="presentation"><a data-toggle="pill" href="#dislike"><i class="fa fa-thumbs-o-down fa-4x" aria-hidden="true"></i><span class="answer-text">아직도 느려요</span></a></li>
                    </ul>
                </p>

                <div class="tab-content">
                    <div id="like" class="tab-pane fade">
                        <h3>정보통신팀에 감사 메세지 보내기</h3>
                        <div>
                            <form style="margin-top: 30px;">
                                <div class="form-group">
                                    <textarea class="form-control status-box" rows="2" placeholder="감사합니다! 인터넷이 빨라졌어요"></textarea>
                                </div>
                            </form>
                            <div class="button-group pull-right">
                                <p class="counter">140</p>
                                <a class="btn btn-primary comments-post like-comment disabled">Post</a>
                            </div>

                            <ul class="comments">
                            </ul>
                        </div>
                    </div>
                    <div id="dislike" class="tab-pane fade">
                        <h3>이번 주 민원에 참여하기</h3>
                        <div style="text-align:center; margin-top:20px;margin-bottom:20px;">
                            <a href="./collect.html" onclick="trackOutboundLink('./collect.html','participate'); return false;" class="btn btn-success btn-lg">동참하기</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END Response from school -->

            <ul id="nested-comment" class="media-list"></ul>

            <!-- Statistics overview-->
            <div class="post">
                <h2 class="page-header" id="stat">
                    <a href="#stat" data-anchorjs-icon=""></a>학교에 전송</h2>

                <div class="row">
                    <div class="col-sm-8">
                        <p>아, 쫌 런칭 후 총 308개의 제보가 접수(5/12기준)되었습니다. 안정적인 인터넷은 학생들의 학습력과 직결된 문제이지만 많은 예산과 인력이 필요하다는 이유로 아직까지 학생들은 불편함을 겪고 있습니다. 운영진은 제보를 계속 모아 학교에 지속적으로 변화를 촉구할 것입니다.</p>
                        <div class="table-responsive">
                            <table class="overall-stat detailed-data table table-striped table-hover table-inbox">
                                <thead>
                                    <tr>
                                        <th>건물명</th>
                                        <th>제보 개수</th>
                                        <th>Download(Mbps)</th>
                                        <th>Upload(Mbps)</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <svg id="timeStat"></svg></div>
                </div>
            </div>
            <!-- END Statistics overview-->

            <!-- Statistics overview-->
            <div class="post">
                <h2 class="page-header" id="launch">
                    <a href="#launch" data-anchorjs-icon=""></a>아,쫌 런칭</h2>

                <p>4월 4일, 총학생회와 정보통신팀과의 긴 협력끝에 드디어 아,쫌이 세상에 알려졌습니다! 학교는 중복되고 산발된 제보에 집행력을 집중하지 못합니다. 정리되지 않은 정보로 문제 원인을 정확히 찾아내지 못합니다. 아,쫌은 짧은 시간에 인터넷 문제의 불편함을 제보 할 수 있게 하고 이를 학교함으로써 학교에 인터넷 문제 해결을 지속적으로 요청할 것입니다. </p>
            </div>
            <!-- END Statistics overview-->

        </div>
    </div>

    <div class="modal fade" id="ios-prompt-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title">아래 URL을 복사해주세요</h4>
                </div>
                <div class="modal-body">
                    <input id="ios-url" type="text" />
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <ul class="footer-links right-links">
                <li><a href="mailto:kixlab.rally@gmail.com">contact</a></li>
                <li><a href="./privacy.html">privacy</a></li>
                <li>ver 0.46</li>
            </ul>
            <ul class="footer-links">
                <li>© 2017 KIXLAB</li>
                <li><a href="https://kixlab.org">KIXLAB</a></li>
                <li><a href="https://student.kaist.ac.kr/">학부총학생회</a></li>
                <li><a href="https://ict.kaist.ac.kr">정보통신팀</a></li>
            </ul>
        </div>
    </footer>
    <script type="text/javascript">
        $(function() {
            $('[data-toggle="tooltip"]').tooltip()
        })

    /* Test json
       Delete after backend implementation*/
    var json = {
        "news" : {
          "comments" : {
            "2017-04-27T16:08:28" : {
              "comments" : {
                "2017-04-28T16:08:28" : {
                  "content" : "2017-04-28T16:08:28",
                  "type" : 1
                }
              },
              "content" : "2017-04-27T16:08:28",
              "type" : 0
            },
            "2017-04-29T16:08:28" : {
              "content" : "2017-04-29T16:08:28",
              "type" : 0
            },
            "2017-04-30T16:08:28" : {
              "comments" : {
                "2017-04-31T16:08:28" : {
                  "comments" : {
                      "2017-05-01T16:08:28" : {
                        "content" : "2017-05-01T16:08:28",
                        "type" : 1
                      }
                  },
                  "content" : "2017-04-31T16:08:28",
                  "type" : 1
                },
                "2017-05-02T16:08:28" : {
                  "content" : "2017-05-02T16:08:28",
                  "type" : 1
                }
              },
              "content" : "2017-04-30T16:08:28",
              "type" : 0
            },
          }
        },
    }

    append_nested_comment("nested-comment", json.news);

    /* @param {string} nc_id - id of root node. must be <ul>
       @param {object} news_json - object from database
       Traverse news_json and append recursively comments
       which has "content" key */
    function append_nested_comment (nc_id, news_json) {
        /* deep copy */
        var c_news_json = $.extend(true, {}, news_json);
        /* traversal */
        for (var key in c_news_json) {
            /* if is_comment: append comment */
            if(is_key(c_news_json[key], "content")) {
                append_comment_html(nc_id, key, c_news_json[key]);
            }
            /* if is_leaf: break; */
            if(typeof(c_news_json[key]) != "object") {
                break;
            }
            /* Recursive call to child json */
            var parent_id = (key != "comments") ? nc_id + "-" + key : nc_id;
            append_nested_comment (parent_id, c_news_json[key])
        }
    }

    function append_comment_html (parent_id, date, news_json) {
        var c_news_json = $.extend(true, {}, news_json);
        var new_id = parent_id + "-" + date;
        delete c_news_json["comments"];

        /* mockup */
        var img = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+PGRlZnMvPjxyZWN0IHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgZmlsbD0iI0VFRUVFRSIvPjxnPjx0ZXh0IHg9IjEzLjQ2ODc1IiB5PSIzMiIgc3R5bGU9ImZpbGw6I0FBQUFBQTtmb250LXdlaWdodDpib2xkO2ZvbnQtZmFtaWx5OkFyaWFsLCBIZWx2ZXRpY2EsIE9wZW4gU2Fucywgc2Fucy1zZXJpZiwgbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMHB0O2RvbWluYW50LWJhc2VsaW5lOmNlbnRyYWwiPjY0eDY0PC90ZXh0PjwvZz48L3N2Zz4=";
        var title = date;
        var content = "Lorem ipsum dolor sit amet, consectetur adipiscing elit / " + news_json.content + " / " + news_json.type;

        /* Build comment html */
        var html =
        '<li class="media">'+
            '<div class="media-left">'+
                '<img class="media-object" src=' + img + '>'+
            '</div>'+
            '<div class="media-body" id=' + new_id + '>'+
                '<h4 class="media-heading">'+ title +'</h4>'+
                '<div id=' +'comment-' + new_id + '>' +
                    '<p>' + content + '</p>'+
                    '<i class="fa fa-reply" aria-hidden="true"></i>'+
                    '<i class="fa fa-heart" aria-hidden="true"></i>'+
                '</div>'+
            '</div>'+
        '</li>';
        var $html = $(html);

        /* Append html */
        $(document.getElementById(parent_id)).append($html);
    }

    function is_key(obj, key) {
        return (Object.keys(obj).indexOf(key.toString()) !== -1);
    }
    </script>
</body>

</html>
